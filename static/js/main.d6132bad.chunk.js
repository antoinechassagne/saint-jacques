(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{180:function(e,t,a){e.exports=a(309)},308:function(e,t,a){},309:function(e,t,a){"use strict";a.r(t);var n=a(1),c=a.n(n),r=a(162),l=a.n(r),s=a(47),i=a(19),o=function(e){var t=document.cookie.match(new RegExp("(^| )".concat(e,"=([^;]+)")));return t?t[2]:null},u=function(e,t){document.cookie="".concat(e,"=").concat(t)},m=function(e){document.cookie="".concat(e,"=;expires=Thu, 01 Jan 1970 00:00:00 GMT; path=/saint-jacques")},d=function(e){var t=Object.keys(e.pages).filter((function(t){return e.pages[t].menu})).map((function(t){return e.pages[t]}));return c.a.createElement("header",{className:"header mb--xl"},c.a.createElement("nav",null,c.a.createElement(i.c,{exact:!0,to:"".concat("/saint-jacques"),className:"header__brand"},"Saint Jacques"),c.a.createElement("ul",{className:"header__menu"},Object.keys(t).map((function(e,a){return c.a.createElement("li",{key:a},c.a.createElement(i.c,{exact:!0,to:"".concat("/saint-jacques").concat(t[e].path),activeClassName:"active"},t[e].label))})))),e.isLogged&&c.a.createElement("button",{onClick:function(){m("jwt"),window.location.replace("".concat("/saint-jacques").concat(e.pages.home.path))}},"Se d\xe9connecter"),!e.isLogged&&c.a.createElement("button",{onClick:function(){window.location.replace("".concat("/saint-jacques").concat(e.pages.signIn.path))}},e.pages.signIn.label))},p=a(9),f=function(){return Math.random().toString(36).substring(2,5)+Math.random().toString(36).substring(2,5)},b=function(){return c.a.createElement("div",{class:"loader",title:"0"},c.a.createElement("svg",{version:"1.1",xmlns:"http://www.w3.org/2000/svg",x:"0px",y:"0px",width:"40px",height:"40px",viewBox:"0 0 40 40","enable-background":"new 0 0 40 40"},c.a.createElement("path",{opacity:"0.2",fill:"#000",d:"M20.201,5.169c-8.254,0-14.946,6.692-14.946,14.946c0,8.255,6.692,14.946,14.946,14.946 s14.946-6.691,14.946-14.946C35.146,11.861,28.455,5.169,20.201,5.169z M20.201,31.749c-6.425,0-11.634-5.208-11.634-11.634 c0-6.425,5.209-11.634,11.634-11.634c6.425,0,11.633,5.209,11.633,11.634C31.834,26.541,26.626,31.749,20.201,31.749z"}),c.a.createElement("path",{fill:"#000",d:"M26.013,10.047l1.654-2.866c-2.198-1.272-4.743-2.012-7.466-2.012h0v3.312h0 C22.32,8.481,24.301,9.057,26.013,10.047z"},c.a.createElement("animateTransform",{attributeType:"xml",attributeName:"transform",type:"rotate",from:"0 20 20",to:"360 20 20",dur:"0.5s",repeatCount:"indefinite"}))))},h=function(e){var t=Object(n.useState)(!1),a=Object(p.a)(t,2),r=a[0],l=a[1],s=Object(n.useState)(!1),o=Object(p.a)(s,2),u=o[0],m=o[1],d=Object(n.useState)([]),h=Object(p.a)(d,2),E=h[0],v=h[1],g=Object(n.useState)(!1),j=Object(p.a)(g,2),O=j[0],S=j[1],w=Object(n.useState)(null),k=Object(p.a)(w,2),y=k[0],q=k[1],N=Object(n.useState)(null),x=Object(p.a)(N,2),C=x[0],L=x[1],_=Object(n.useRef)(null),F=Object(n.useRef)(null),z=Object(n.useCallback)((function(e){e.target.isSameNode(F.current)||e.target.isSameNode(_.current)||(S(!1),F.current.value="",window.removeEventListener("click",z))}),[]),A=function(t){l(!0),S(!0);var a=t.target.value;if(!a)return v([]),void S(!1);clearTimeout(q(y)),q(setTimeout((function(){var t;L(f()),t=a,C===C&&(m(!1),e.search(t).then((function(e){var t=e.data;v(t),l(!1)})).catch((function(){m(!0),l(!1)})))}),800))};Object(n.useEffect)((function(){return O?window.addEventListener("click",z):window.removeEventListener("click",z),function(){return window.removeEventListener("click",z)}}),[O,z]);return c.a.createElement("div",{className:"search"},c.a.createElement("div",{className:"input"},c.a.createElement("label",{className:"input__label",htmlFor:e.name},e.label),c.a.createElement("input",{className:"input__input",type:"text",name:e.name,ref:F,onChange:function(e){A(e)}})),c.a.createElement("div",{ref:_,className:O?"search__results search__results--active":"search__results"},r?c.a.createElement(b,null):u?c.a.createElement("span",null,"Une erreur est survenue."):E.length?c.a.createElement("ul",null,E.map((function(e,t){return c.a.createElement("li",{key:t},c.a.createElement(i.b,{to:"".concat("/saint-jacques","/spots/").concat(e.id)},e.name))}))):c.a.createElement("span",null,"Aucun r\xe9sultat trouv\xe9.")))},E=a(165),v=a.n(E).a.create({baseURL:"https://saint-jacques.herokuapp.com/api"});v.interceptors.request.use((function(e){var t=o("jwt");return null!=t&&(e.headers.Authorization="Bearer ".concat(t)),e}),(function(e){return Promise.reject(e)})),v.interceptors.response.use((function(e){return e}),(function(e){return 401===e.response.status&&(m("jwt"),document.location.reload(!0),window.location.replace("".concat("/saint-jacques").concat(G.signIn.path))),404===e.response.status&&window.location.replace("".concat("/saint-jacques").concat(G.notFound.path)),Promise.reject(e)}));var g=v,j={fetchSpots:function(){return g.get("/spots")},fetchSpot:function(e){return g.get("/spots/".concat(e))},searchSpot:function(e){return g.get("/search/spots",{params:{search:e}})}},O={fetchUserFavoriteSpots:function(){return g.get("/users/favorite-spots")},addFavoriteSpot:function(e){return g.get("/users/add-favorite-spot",{params:{spot:e}})},removeFavoriteSpot:function(e){return g.get("/users/remove-favorite-spot",{params:{spot:e}})}},S=function(){document.title="Saint Jacques";var e=Object(n.useState)([]),t=Object(p.a)(e,2),a=t[0],r=t[1],l=Object(n.useState)(!0),s=Object(p.a)(l,2),u=s[0],m=s[1],d=Object(n.useState)(!1),f=Object(p.a)(d,2),E=(f[0],f[1]),v=!!o("jwt");Object(n.useEffect)((function(){v&&(m(!0),v&&O.fetchUserFavoriteSpots().then((function(e){var t=e.data;m(!1),r(t)})).catch((function(){E(!0),m(!1)})))}),[]);return c.a.createElement("section",null,c.a.createElement("h1",null,"Bienvenue sur Saint Jacques"),c.a.createElement(h,{label:"Rechercher un spot",search:j.searchSpot}),function(){if(v)return c.a.createElement("div",{className:"mb--l"},c.a.createElement("h2",{className:"mt--l"},"Vos spots favoris"),u&&c.a.createElement(b,null),!u&&!a.length&&c.a.createElement("span",null,"Aucun spots favoris."),a.map((function(e){return c.a.createElement(i.b,{to:"".concat("/saint-jacques","/spots/").concat(e.id)},c.a.createElement("h4",{className:"d-block mt--m"},e.name))})))}())},w=function(e){var t=e.email,a=e.password;return g.post("/signin",{email:t,password:a})},k=function(e){var t=e.email,a=e.password;return g.post("/signup",{email:t,password:a})},y=a(177),q=function(e){return c.a.createElement("button",{className:"button button--primary"},e.children)},N=function(e){var t=Object(n.useState)({}),a=Object(p.a)(t,2),r=a[0],l=a[1],s=function(e){var t=Object(y.a)({},r);e.valid?t[e.name]=e:(delete t[e.name].value,t[e.name].valid=!1),l(t)},i=function(){var t={},a=!1;Object.keys(r).forEach((function(e){a||(r[e].valid?Object.prototype.hasOwnProperty.call(r[e],"value")&&(t[r[e].name]=r[e].value):a=!0)})),console.log(t),a||e.submit(t)},o=c.a.Children.map(e.children,(function(e){if(e)return c.a.cloneElement(e,{inputChange:s})})).filter((function(e){return e}));return Object(n.useEffect)((function(){var t={};e.children.forEach((function(e){e&&(t[e.props.name]={name:e.props.name,valid:!e.props.required,required:!!e.props.required})})),l(t)}),[l]),c.a.createElement("form",{className:"form",onSubmit:function(e){e.preventDefault(),i()}},o,c.a.createElement(q,{onClick:function(){i()}},e.buttonLabel))},x=function(e){var t=Object(n.useState)(""),a=Object(p.a)(t,2),r=a[0],l=a[1],s=Object(n.useState)(!0),i=Object(p.a)(s,2),o=i[0],u=i[1],m=Object(n.useState)(!0),d=Object(p.a)(m,2),f=d[0],b=d[1];return Object(n.useEffect)((function(){f||function(){if(e.validation&&!f)if(!e.required||r){var t=new RegExp("[^@]+@[^.]+..+"),a=r.match(t);u(!!a)}else u(!1)}(),e.inputChange({name:e.name,value:r,valid:o,required:e.required})}),[f,r,o]),c.a.createElement("div",{className:"input"},c.a.createElement("label",{className:"input__label",htmlFor:e.name},e.label),c.a.createElement("input",{className:"input__input",type:"email",value:r,name:e.name,required:e.required,onChange:function(e){return l(e.target.value)},onBlur:function(e){f?b(!1):l(e.target.value)}}),!o&&c.a.createElement("span",{className:"error"},"Veuillez saisir une adresse email valide."))},C=function(e){var t=Object(n.useState)(""),a=Object(p.a)(t,2),r=a[0],l=a[1],s=Object(n.useState)(!0),i=Object(p.a)(s,2),o=i[0],u=i[1],m=Object(n.useState)(!0),d=Object(p.a)(m,2),f=d[0],b=d[1];return Object(n.useEffect)((function(){f||function(){if(e.validation&&!f)if(!e.required||r){var t=r.match(/^(?=.*\d)(?=.*[a-z])(?=.*[A-Z])(?=.*[^a-zA-Z0-9])(?!.*\s).{8,15}$/);u(!!t)}else u(!1)}(),e.inputChange({name:e.name,value:r,valid:o,required:e.required})}),[f,r,o]),c.a.createElement("div",{className:"input"},c.a.createElement("label",{className:"input__label",htmlFor:e.name},e.label),c.a.createElement("input",{className:"input__input",type:"password",value:r,name:e.name,required:e.required,onChange:function(e){return l(e.target.value)},onBlur:function(e){f?b(!1):l(e.target.value)}}),!o&&c.a.createElement("p",{className:"error"},"Le mot de passe doit contenir au moins 8 caract\xe8res (dont au moins une majuscule, une minuscule, un chiffre et un caract\xe8re sp\xe9cial)."))},L=function(){document.title="Saint Jacques | Se connecter";var e=Object(n.useState)(!1),t=Object(p.a)(e,2),a=t[0],r=t[1],l=Object(n.useState)(!1),s=Object(p.a)(l,2),o=s[0],m=s[1];return c.a.createElement("section",{className:"page page--sign-in"},c.a.createElement("h1",null,"Se connecter"),o&&c.a.createElement("span",{class:"error"},"Les identifiants saisis ne sont pas valides."),c.a.createElement(N,{submit:function(e){return function(e){r(!0);var t=e.email,a=e.password;w({email:t,password:a}).then((function(e){200===e.status?(u("jwt",e.data.token),window.location.replace("".concat("/saint-jacques"))):(m(!0),r(!1))})).catch((function(){m(!0),r(!1)}))}(e)},buttonLabel:"Se connecter"},c.a.createElement(x,{required:!0,validation:!0,name:"email",label:"Email"}),c.a.createElement(C,{required:!0,validation:!1,name:"password",label:"Mot de passe"})),a&&c.a.createElement(b,null),c.a.createElement("span",{className:"mt--s mb--xs d-block"},"Vous n'avez pas encore de compte ?"," ",c.a.createElement(i.c,{exact:!0,to:"".concat("/saint-jacques").concat(G.signUp.path)},"Cr\xe9ez en un d\xe8s maintenant !")))},_=function(){document.title="Saint Jacques | S'inscrire";var e=Object(n.useState)(!1),t=Object(p.a)(e,2),a=t[0],r=t[1],l=Object(n.useState)(!1),s=Object(p.a)(l,2),i=s[0],o=s[1],m=Object(n.useState)(!0),d=Object(p.a)(m,2),f=d[0],h=d[1];return c.a.createElement("section",{class:"page page--sign-up"},c.a.createElement("h1",null,"S'inscrire"),i&&c.a.createElement("span",{className:"error d-block mb--m"},"Les identifiants saisis ne sont pas valides. Il se peut que l'adresse email saisie soit d\xe9j\xe0 associ\xe9e \xe0 un compte."),c.a.createElement(N,{submit:function(e){return function(e){var t=e.email,a=e.password,n=e.passwordConfirmation;a===n?(h(!0),r(!0),k({email:t,password:a}).then((function(){w({email:t,password:a}).then((function(e){u("jwt",e.data.token),window.location.replace("".concat("/saint-jacques"))})).catch((function(){o(!0),r(!1)}))})).catch((function(){o(!0),r(!1)}))):h(!1)}(e)},buttonLabel:"S'inscrire"},c.a.createElement(x,{required:!0,validation:!0,name:"email",label:"Adresse email"}),c.a.createElement(C,{required:!0,validation:!0,name:"password",label:"Mot de passe"}),c.a.createElement(C,{required:!0,name:"passwordConfirmation",label:"Conformation du mot de passe"}),!f&&c.a.createElement("span",{className:"error d-block mb--s"},"Les mots de passe saisis ne sont pas identiques.")),a&&c.a.createElement(b,null))},F=function(){document.title="Saint Jacques | Spots";var e=Object(n.useState)([]),t=Object(p.a)(e,2),a=t[0],r=t[1],l=Object(n.useState)(!0),s=Object(p.a)(l,2),o=s[0],u=s[1],m=Object(n.useState)(!1),d=Object(p.a)(m,2),f=d[0],h=d[1];Object(n.useEffect)((function(){j.fetchSpots().then((function(e){var t=e.data;r(t["hydra:member"]),u(!1)})).catch((function(){h(!0),u(!1)}))}),[]);return c.a.createElement("section",null,c.a.createElement("h1",null,"Tous les spots"),o?c.a.createElement(b,null):f?c.a.createElement("span",null,"Une erreur est survenue."):a.length?c.a.createElement("ul",null,a.map((function(e,t){return c.a.createElement("li",{key:t},c.a.createElement(i.b,{to:"".concat("/saint-jacques","/spots/").concat(e.id)},c.a.createElement("h2",null,e.name)),c.a.createElement("p",{className:"d-block mb--l"},e.description))}))):c.a.createElement("span",null,"Aucun spot trouv\xe9."))},z=a(317),A=a(321),U=a(319),J=a(175),M=a(320),I=a(322),R=a(22),T=a.n(R);a(71);T.a.locale("fr");var B=function(e,t){return!!e[t][0]&&(e.ts=e.ts.splice(0,Math.floor(e.ts.length/2)),e.ts.map((function(a,n){return{x:T()(a),y:parseFloat(e[t][n].toFixed(2))}})))};T.a.locale("fr");var D=function(e){var t=B(e.data,"waves_height-surface");return t?c.a.createElement("div",null,c.a.createElement("h4",null,"Hauteur des vagues "),c.a.createElement(z.a,{animate:{duration:1e3},theme:A.a.material,width:e.width,height:e.height},c.a.createElement(U.a,{tickFormat:function(e){var t=T()(e).calendar();return t.charAt(0).toUpperCase()+t.slice(1)},tickLabelComponent:c.a.createElement(J.a,null,c.a.createElement(M.a,null)),style:{tickLabels:{fontSize:6,angle:-45,padding:10,textAnchor:"end"}}}),c.a.createElement(U.a,{dependentAxis:!0,tickFormat:function(e){return"".concat(e,"m")},style:{tickLabels:{fontSize:6}}}),c.a.createElement(I.a,{data:t,interpolation:"basis",labels:function(e){var t=e.datum;return"".concat(t.y.toFixed(1)," m")},style:{data:{fill:"cyan",stroke:"cyan",fillOpacity:.4,strokeWidth:2},labels:{fill:"cyan",fontSize:6,fontWeight:600}}}))):c.a.createElement("span",{className:"d-block mt--m error"},"Une erreur s'est produite lors du chargement des donn\xe9es.")},W=a(318);T.a.locale("fr");var P=function(e){var t=B(e.data,"waves_period-surface");return t?c.a.createElement("div",null,c.a.createElement("h4",null,"P\xe9riode des vagues"),c.a.createElement(z.a,{animate:{duration:1e3},theme:A.a.material,width:e.width,height:e.height},c.a.createElement(U.a,{tickFormat:function(e){var t=T()(e).calendar();return t.charAt(0).toUpperCase()+t.slice(1)},tickLabelComponent:c.a.createElement(J.a,null,c.a.createElement(M.a,null)),style:{tickLabels:{fontSize:6,angle:0,padding:10,textAnchor:"middle"}}}),c.a.createElement(U.a,{dependentAxis:!0,tickFormat:function(e){return"".concat(e," s")},style:{tickLabels:{fontSize:6}}}),c.a.createElement(W.a,{data:t,interpolation:"basis",barRatio:.6,labels:function(e){return e.datum.y.toFixed(1)+"s"},labelComponent:c.a.createElement(M.a,{dy:30}),style:{data:{fill:"cyan",opacity:.4},labels:{fill:"cyan",fontSize:6,fontWeight:600}}}))):c.a.createElement("span",{className:"d-block mt--m error"},"Une erreur s'est produite lors du chargement des donn\xe9es.")},V=a(323);T.a.locale("fr");var Z=function(e){console.log(e.data);var t=B(e.data,"temp-surface").map((function(e){return{x:e.x,y:e.y-273.15}})),a=t.splice(0,Math.floor(t.length/2));return a?c.a.createElement("div",null,c.a.createElement("h4",null,"Temp\xe9rature"),c.a.createElement(z.a,{maxDomain:{y:40},minDomain:{y:0},animate:{duration:1e3},theme:A.a.material,width:e.width,height:e.height},c.a.createElement(U.a,{tickFormat:function(e){var t=T()(e).calendar();return t.charAt(0).toUpperCase()+t.slice(1)},tickLabelComponent:c.a.createElement(J.a,null,c.a.createElement(M.a,null)),style:{tickLabels:{fontSize:6,angle:0,padding:10,textAnchor:"middle"}}}),c.a.createElement(U.a,{dependentAxis:!0,tickFormat:function(e){return"".concat(e," s")},style:{tickLabels:{fontSize:6}}}),c.a.createElement(V.a,{data:a,interpolation:"natural",labels:function(e){var t=e.datum;return"".concat(t.y.toFixed(1)," \xb0C")},style:{data:{stroke:"cyan",fillOpacity:.4,strokeWidth:2},labels:{fill:"cyan",fontSize:6,fontWeight:600}}}))):c.a.createElement("span",{className:"d-block mt--m error"},"Une erreur s'est produite lors du chargement des donn\xe9es.")},G={home:{path:"/",label:"Accueil",component:S,menu:!1,guard:!1},spots:{path:"/spots",label:"Spots",component:F,menu:!0,guard:!1},spot:{path:"/spots/:id",label:"Spot",component:function(){document.title="Saint Jacques | Chargement...";var e=Object(n.useState)(!0),t=Object(p.a)(e,2),a=t[0],r=t[1],l=Object(n.useState)(!1),i=Object(p.a)(l,2),u=i[0],m=i[1],d=Object(n.useState)(!1),f=Object(p.a)(d,2),h=f[0],E=f[1],v=Object(n.useState)(!1),g=Object(p.a)(v,2),S=(g[0],g[1]),w=Object(n.useState)(!1),k=Object(p.a)(w,2),y=(k[0],k[1]),q=Object(n.useState)(null),N=Object(p.a)(q,2),x=N[0],C=N[1],L=Object(s.g)();Object(n.useEffect)((function(){j.fetchSpot(L.id).then((function(e){var t=e.data;document.title="Saint Jacques | ".concat(t.name),C(t),E(t.isFavorite),r(!1)})).catch((function(){m(!0),r(!1)}))}),[]);var _=function(){return!!o("jwt")?c.a.createElement("button",{onClick:function(){return y(!0),S(!0),void O[h?"removeFavoriteSpot":"addFavoriteSpot"](L.id).then((function(){S(!1),E(!h)})).catch((function(){y(!0),S(!1)}))},className:"mt--l"},h?"Retirer de mes favoris":"Ajouter \xe0 mes favoris"):c.a.createElement("div",{className:"mt--m"},c.a.createElement("span",null,"Connectez-vous pour ajouter ce spot \xe0 vos favoris"),c.a.createElement("a",{className:"ml--s link",onClick:function(){window.location.replace("".concat("/saint-jacques").concat(G.signIn.path))}},"Se connecter"))};return c.a.createElement("section",{className:"page"},a?c.a.createElement(b,null):u?c.a.createElement("span",null,"Une erreur est survenue."):c.a.createElement("section",null,c.a.createElement("h1",null,x.name),c.a.createElement("span",{className:"d-block mb--xs"},"Longitude : ",x.longitude),c.a.createElement("span",{className:"d-block mb--xs"},"Latitude : ",x.latitude),c.a.createElement("p",null,x.description),_(),c.a.createElement("div",{className:"mt--l"},c.a.createElement(D,{data:x.wavewatchData,width:700,height:200}),c.a.createElement(P,{data:x.wavewatchData,width:700,height:200}),c.a.createElement(Z,{data:x.gfsData,width:700,height:200}))))},menu:!1,guard:!1},signIn:{path:"/sign-in",label:"Se connecter",component:L,menu:!1,guard:!1},signUp:{path:"/sign-up",label:"S'inscrire'",component:_,menu:!1,guard:!1},notfound:{path:"/404",label:"Erreur 404",component:function(){return document.title="Saint Jacques |\xa0404",c.a.createElement("section",null,c.a.createElement("h1",null,"Erreur 404"),c.a.createElement("p",null,"Cette pas n'existe pas..."," ",c.a.createElement("span",{role:"img","aria-label":"Sad face emoji"},"\ud83d\ude1e")))},menu:!1,guard:!1}},H=function(){var e=!!o("jwt"),t=Object.keys(G).map((function(t,a){var n=G[t],r=n.path,l=n.component,i=n.guard;return c.a.createElement(s.b,{key:a,exact:!0,path:"".concat("/saint-jacques").concat(r),render:function(){return function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=arguments.length>1?arguments[1]:void 0,n=a;return t?e?c.a.createElement(n,null):c.a.createElement(s.a,{to:"".concat("/saint-jacques").concat(G.signIn.path)}):c.a.createElement(n,null)}(i,l)}})}));return c.a.createElement(i.a,null,c.a.createElement(c.a.Fragment,null,c.a.createElement(d,{pages:G,isLogged:e}),c.a.createElement("main",{className:"container"},c.a.createElement(s.d,null,t))))};a(308);l.a.render(c.a.createElement(c.a.StrictMode,null,c.a.createElement(H,null)),document.getElementById("root"))}},[[180,1,2]]]);
//# sourceMappingURL=main.d6132bad.chunk.js.map